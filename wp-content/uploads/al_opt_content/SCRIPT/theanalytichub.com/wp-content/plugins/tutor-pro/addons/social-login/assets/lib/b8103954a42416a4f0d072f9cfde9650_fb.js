let __=wp.i18n.__,defaultErrMsg=__("Something went wrong, please try again","tutor-pro"),{facebook_app_id,current_user_id,logout_url}=tutorProSocialLogin;function checkLoginState(){FB.getLoginStatus(function(t){statusChangeCallback(t)})}function statusChangeCallback(c){"connected"===c.status&&FB.api("/me",{locale:"en_US",fields:"name,email,first_name,last_name,picture"},async t=>{var e=document.querySelector("form input[name=tutor_action]"),a=document.querySelector("form input[name=redirect_to]");let o="tutor_user_login";e&&(o=e.value);e=tutorFormData([{action:"tutor_pro_social_authentication"},{token:c.authResponse.accessToken},{auth:"facebook"},{first_name:t.first_name},{last_name:t.last_name},{user_login:t.name.replace(" ","_")},{email:t.email},{auth_user_id:t.id},{profile_url:t.picture&&t.picture.data?t.picture.data.url:""},{attempt:o}]);try{tutor_toast(__("Authentication Processed","tutor-pro"),__("Please wait...","tutor-pro"),"success");var{success:r,data:n}=await(await ajaxHandler(e)).json();if(r)tutor_toast(__("Authentication success","tutor-pro"),n,"success"),window.location.href=a?a.value+'"?nocache='+(new Date).getTime():_tutorobject.tutor_frontend_dashboard_url+'"?nocache='+(new Date).getTime();else{if(Array.isArray(n)){var i=n[0];if(i&&"tutor_login_limit"===i.code)return void document.querySelector(".tutor-login-form-wrapper").insertAdjacentHTML("afterbegin",`<div class="tutor-alert tutor-warning tutor-mb-12" style="display:block;">${i.message}</div>`)}tutor_toast(__("Authentication failed","tutor-pro"),n,"error")}}catch(t){tutor_toast(__("Authentication failed","tutor-pro"),defaultErrMsg,"error")}})}function tutorFormData(t=[]){let o=new FormData;return t.forEach(t=>{for(var[e,a]of Object.entries(t))o.set(e,a)}),o.set(window.tutor_get_nonce_data(!0).key,window.tutor_get_nonce_data(!0).value),o}async function ajaxHandler(t){try{return await fetch(window._tutorobject.ajaxurl,{method:"POST",body:t})}catch(t){tutor_toast(__("Operation failed","tutor"),t,"error")}}!function(t,e,a){var o=t.getElementsByTagName(e)[0];t.getElementById(a)||((t=t.createElement(e)).id=a,t.src="//connect.facebook.net/en_US/all.js",t.async=!0,o.parentNode.insertBefore(t,o))}(document,"script","facebook-jssdk"),window.fbAsyncInit=function(){FB.init({appId:facebook_app_id,cookie:!0,xfbml:!0,version:"v16.0"})};